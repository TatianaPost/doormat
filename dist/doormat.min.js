/*
 * doormat - http://jh3y.github.io/doormat
 *
 * @license MIT
 * @author jh3y
 * (c) 2016
 */
(function(){var e,t;t={CLASS:"dm",CURRENT_CLASS:"dm__pnl--crnt",NEXT:"next",PREVIOUS:"previous",RESET:"reset",snapping:{travel:!1,viewport:!0,threshold:30,debounce:150,duration:250}},e=window.Doormat=function(n){var o,r,i,O,T,s,S,P,N;if(O=document.querySelector("."+t.CLASS),!(this instanceof e))return new e(n);if(!O)throw Error("Doormat: Must assign element instance");return N=function(e){var n;return n=i.current,n.className=n.className.replace(t.CURRENT_CLASS,""),n.style.top=e===t.NEXT?-n.offsetHeight+"px":0,i.current=e===t.RESET?i.panels[0]:n[e+"ElementSibling"],i.current.className+=" "+t.CURRENT_CLASS},o=function(e){var n,o,r,O;O=0,o=0,n="onorientationchange"in window?screen.height:window.innerHeight,i.CLIENT_HEIGHT=n;for(;o<i.panels.length;)r=i.panels[o],r.style.zIndex=999-o,r.style.display="block",r.style.minHeight=n+"px",r.style.top="0px",r.DOORMAT_HEIGHT=r.offsetHeight,r.DOORMAT_POS=O,O+=r.DOORMAT_HEIGHT,o++;return i.SNAP_THRESHOLD=n*(t.SNAPPING.THRESHOLD/100),document.body.style.height=O+"px",e?(window.scrollTo(0,0),N(t.RESET)):void 0},r=function(e,t){clearTimeout(e.TIMER),e.TIMER=setTimeout(e,t)},S=function(){var e,n,o,r,O,T;if(e=i.current,o=window.scrollY||window.pageYOffset,O=function(){return window.scrollTo(0,e.DOORMAT_POS+(e.offsetHeight-i.CLIENT_HEIGHT))},T=function(){return e.style.top=-e.offsetHeight+"px",N(t.NEXT),window.scrollTo(0,i.current.DOORMAT_POS)},P()&&o!==e.DOORMAT_POS&&(n=function(){return e.style.transitionProperty=null,e.style.transitionDuration=null,e.removeEventListener("transitionend",n)},r=function(){return e.style.transitionProperty="top",e.style.transitionDuration=t.SNAPPING.DURATION,e.addEventListener("transitionend",n,!1)},i.SNAP_TOP&&(t.SNAPPING.VIEWPORT?(r(),T()):t.SNAPPING.TRAVEL&&"UP"===i.SCROLL_DIR&&window.scrollTo(0,e.DOORMAT_POS)),i.SNAP_BOTTOM)){if(r(),t.SNAPPING.VIEWPORT)return O();if(t.SNAPPING.TRAVEL&&"DOWN"===i.SCROLL_DIR)return T()}},P=function(){var e,n;return e=i.current,n=window.scrollY||window.pageYOffset,i.SNAP_TOP=!1,i.SNAP_BOTTOM=!1,i.SNAP_TOP=t.SNAPPING.VIEWPORT?n>e.offsetHeight+e.DOORMAT_POS-i.SNAP_THRESHOLD&&n<e.DOORMAT_POS+e.offsetHeight:n>e.DOORMAT_POS+(e.offsetHeight-i.SNAP_THRESHOLD)&&n<e.DOORMAT_POS+e.offsetHeight,i.SNAP_BOTTOM=t.SNAPPING.VIEWPORT?n>e.DOORMAT_POS+e.offsetHeight-i.CLIENT_HEIGHT&&n<e.DOORMAT_POS+e.offsetHeight-i.CLIENT_HEIGHT+i.SNAP_THRESHOLD:n>e.DOORMAT_POS+(e.offsetHeight-i.CLIENT_HEIGHT)+i.SNAP_THRESHOLD,i.SNAP_TOP||i.SNAP_BOTTOM},s=function(){var e,n;return e=i.current,n=window.scrollY||window.pageYOffset,i.SCROLL_DIR=n>i.SCROLL_LAST?"DOWN":"UP",i.SCROLL_LAST=n,e.style.top=e.DOORMAT_POS-n+"px",n>e.DOORMAT_HEIGHT+e.DOORMAT_POS?e.nextElementSibling&&N(t.NEXT):n<e.DOORMAT_POS&&e.previousElementSibling&&N(t.PREVIOUS),t.SNAPPING&&(t.SNAPPING.VIEWPORT||t.SNAPPING.TRAVEL)&&P()?r(S,t.SNAPPING.DEBOUNCE):void 0},"onorientationchange"in window?window.onorientationchange=o:window.onresize=o,window.onscroll=s,i=this,i.el=O,i.panels=i.el.children,T=function(e,t){var n,o,r;o={};for(n in e)o[n.toUpperCase()]=e[n],t.hasOwnProperty(n)&&(r=t[n],o[n.toUpperCase()]="object"==typeof r?T(o[n.toUpperCase()],r):r);return o},t=T(t,n),t.SNAPPING&&(t.SNAPPING.DURATION=t.SNAPPING.DURATION/1e3+"s"),i.current=i.panels[0],i.current.className+=" "+t.CURRENT_CLASS,o(),i}}).call(this);